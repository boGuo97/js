<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>[DOM操作]航班起降数据</title>
    <link href="https://cdn.bootcss.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
    <style media="screen">
      .gray{
        background-color:#f7f7f7;
      }
      .hide{
        display:none;
      }
      .edit span:hover{color:#f00;}
      .edit span{
        cursor:pointer;
      }
    </style>
  </head>
  <body>
    <div class="right">
      <h3>XI'AN XIANYANG INT'L AIRPORT (陕西 西安 CN) ZLXY / XIY 离港</h3>
      <hr>
      <table class="table">
        <thead>
          <tr>
            <th>标识符</th>
            <th>机型</th>
            <th>目的地</th>
            <th>出发</th>
            <th>到达</th>
            <td>操作</td>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr>
            <td><div class="siqi">AAR348</div></td>
            <td><div class="siqi">A321</div></td>
            <td><div class="siqi">Incheon Int'l (ICN)</div></td>
            <td><div class="siqi">15:10 CST</div></td>
            <td><div class="siqi">18:14 KST</div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
          <tr id="tem" class="hide">
            <td><div class="siqi"></div></td>
            <td><div class="siqi"></div></td>
            <td><div class="siqi"></div></td>
            <td><div class="siqi"></div></td>
            <td><div class="siqi"></div></td>
            <td class="edit">
              <span class="insertData">插入</span>
              <span>删除</span>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <script>
      var insertData = document.getElementsByClassName('insertData')[0];
      var tbody = document.getElementsByTagName('tbody')[05]
      var tem = document.getElementById("tem")
      tbody.onclick = function(event){
        _this = event.target;
        if(_this.className == "insertData"){
          var newTr = tem.cloneNode(true);
          newTr.id = "";
          newTr.className = "";
          insertAfter(newTr,_this.parentNode.parentNode)
        }
        if(_this.className !== "edit" && _this.tagName == "TD"){
          var text = _this.innerHTML;
          var input = document.createElement("input");
          _this.innerHTML = "";
          _this.appendChild(input);
          input.value = text;
          // 自动获取焦点
          input.focus()

          input.onblur = function(){
            var txt = this.value;
            _this.removeChild(input)
            _this.innerHTML = txt;
          }
          function insertAfter(newElement,node){
        // 返回到父级节点
        var parent = node.parentNode;
        // console.log(parent)
        //判断 目标节点是不是最后一个
        if(parent.lastChild == node){ 
          // 直接插入
              parent.appendChild(newElement);
        }
          else {
              parent.insertBefore(newElement,node.nextSibling);
          }
          return parent.insertBefore(newElement,node.nextSibling);
      }
        }
      }
    </script>
  </body>
</html>